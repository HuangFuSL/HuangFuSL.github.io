# Variables

## 声明

Rust中用于声明变量的关键字是`let`，它的语法如下：

```rust
let [mut] <variable>[: <type>] [= <value>];
```

其中，类型和初始化的值都可以省略。如果一个变量从声明开始没有被赋值，就不能使用这个变量。如果没有指定类型但指定了初始化值，系统则会自动推断变量的类型。Rust还可以用`{}`来用一系列语句来初始化变量，也可以用`()`来一次性声明多个变量。没有用`mut`声明的变量是不可变的，不能被修改。

Rust中用于声明常量的关键字是`const`，用于声明静态变量的关键字是`static`。语法与`let`相似，但需要同时指定类型和初始化值。通常`const`和`static`语句都是在全局作用域（即函数外）中声明的。

`let`可以用来重新声明一个变量，隐藏之前的变量，也可以用`mut`来改变一个变量的可变性。

{{ read_code_from_file('docs/coding/rust/source/1-shadowing.rs') }}

## 变量类型

Rust的变量类型有

* 一般类型
    * 布尔：`bool`，取值为`true`或`false`。
    * 字符：`char`，使用单引号，占用4个字节。
    * 整数：`i8`～`i128`和`isize`，取值范围为$[-2^{n-1}, 2^{n-1} - 1]$，可以用`min_value()`和`max_value()`函数来获取类型的取值范围。`isize`的取值范围和系统指针长度相同。默认的整数类型是`i32`。
    * 无符号整数：`u8`～`u128`和`usize`，取值范围为$[0, 2^n - 1]$。
    * 浮点数：`f32`和`f64`，分别为单精度和双精度浮点数。默认的浮点数类型是`f64`。
    * 字符串：`str`，使用双引号，是不可变类型。字符串字面量（变量）的类型为`&str`，是引用类型。
* 容器及相关类型
    * 使用`println!`打印容器时，需要用`{:?}`或`{:#?}`，前者为一行输出，后者在每个元素后面添加换行符。
    * 定长数组：`[T; N]`，其中`T`为数组元素类型或重复的数组，`N`为数组长度。只有用`mut`声明的数组才能修改其中元素。
    * 定长元组：`(T1, T2, ..., Tn)`，其中`T1`～`Tn`为元组中元素的类型。只有用`mut`声明的元组才能修改其中元素（类型必须匹配）。类似于Python，在变量声明阶段或赋值阶段，仅包含（可以被赋值的）变量元组可以作为赋值运算的左端项，此时会分别为每个变量分配对应的值，省略的变量用`_`表示。元组支持嵌套。单元素元组的语法为`(<value>,)`。
    * 数组切片：`&<parent>[<start>..<end>]`，注意切片是对`<parent>`的引用，是引用类型。元组不支持切片，只能用`.0`、`.1`等来访问元素。
* 函数：需要用`fn(arg1: type1, ...) -> return_type`表示，函数以引用的方式传递。

## 运算符

Rust的运算符与C/C++类似

* 四则运算符：`+ - * / %`
* 比较运算符：`== != > < >= <=`
* 逻辑运算符：`&& || !`
* 位运算符：`& | ^ << >> !`（`!`为按位取反）
* 原位赋值运算符：`+= -= *= /= %= &= |= ^= <<= >>=`等
* 类型转换运算符：`as`，如`let b = (a as f64) / 2.0;`
* 引用与解引用运算符：`& &mut *`，其中`&`用于获取变量的引用（borrow），`&mut`用于获取变量的可变引用，`*`用于解引用。